"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6179,1782],{81782:function(e,t,n){var a=n(5152);let r=n.n(a)()(()=>Promise.all([n.e(5279),n.e(7229)]).then(n.bind(n,47229)),{loadableGenerated:{webpack:()=>[47229]},ssr:!1});t.Z=r},46179:function(e,t,n){n.d(t,{Z:function(){return W}});var a=n(85893),r=n(67294),s=n(68573),i=n(77527),l=n(60990),o=n(96788),c=n(14959),d=n(45214),x=n(93454),u=n(23734);let h=(0,i.ZP)(c.Z)(e=>{let{theme:t}=e;return{height:10,borderRadius:5,["&.".concat(d.Z.colorPrimary)]:{backgroundColor:t.palette.grey["light"===t.palette.mode?200:800]},["& .".concat(d.Z.bar)]:{borderRadius:5,backgroundColor:"".concat(t.palette.success.main)}}}),g=(0,i.ZP)(c.Z)(e=>{let{theme:t}=e;return{height:10,borderRadius:5,["&.".concat(d.Z.colorPrimary)]:{backgroundColor:t.palette.grey["light"===t.palette.mode?200:800]},["& .".concat(d.Z.bar)]:{borderRadius:5,backgroundColor:"".concat(t.palette.warning.main)}}}),b=(0,i.ZP)(c.Z)(e=>{let{theme:t}=e;return{height:10,borderRadius:5,["&.".concat(d.Z.colorPrimary)]:{backgroundColor:t.palette.grey["light"===t.palette.mode?200:800]},["& .".concat(d.Z.bar)]:{borderRadius:5,backgroundColor:"".concat(t.palette.error.main)}}});var p=()=>{let[e,t]=(0,r.useState)(0),[n,s]=(0,r.useState)(0),[i,c]=(0,r.useState)(0),[d,p]=(0,r.useState)(0),m=d-15,Z=(0,r.useRef)(!0);return(0,r.useEffect)(()=>(Z.current=!0,()=>{Z.current=!1}),[]),(0,r.useEffect)(()=>{(async()=>{try{let e=await (0,u.Yu)("GiamSatSoLieu/danhsach");Z.current&&p(e.length)}catch(e){console.log(e)}finally{}})()},[]),(0,r.useEffect)(()=>{t(15/d*100),s(m/d*100),c(7/d*100)},[7,m,15,d]),(0,a.jsxs)(x.Z,{elevation:3,children:[(0,a.jsx)(x.Z,{elevation:3,sx:{py:.5,mb:2,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(o.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"TRẠNG TH\xc1I C\xd4NG TR\xccNH"})}),(0,a.jsxs)(l.Z,{px:5,pb:5,children:[(0,a.jsxs)(o.Z,{children:["Tổng số: ",d," "]}),(0,a.jsxs)(l.Z,{sx:{paddingTop:3},children:[(0,a.jsxs)(o.Z,{children:["Trạm kết nối b\xecnh thường: ",15," "]}),(0,a.jsx)(h,{variant:"determinate",value:e})]}),(0,a.jsxs)(l.Z,{sx:{paddingTop:3},children:[(0,a.jsxs)(o.Z,{children:["Trạm mất kết nối: ",m," "]}),(0,a.jsx)(g,{variant:"determinate",value:n})]}),(0,a.jsxs)(l.Z,{sx:{paddingTop:3},children:[(0,a.jsxs)(o.Z,{children:["Trạm vận h\xe0nh chưa đ\xfang: ",7," "]}),(0,a.jsx)(b,{variant:"determinate",value:i})]})]})]})},m=()=>{let[e,t]=(0,r.useState)(new Date),[n,s]=(0,r.useState)("");return(0,r.useEffect)(()=>{let n=setInterval(()=>{s(e.toLocaleString()),t(new Date)},1e3);return()=>clearInterval(n)},[e]),(0,a.jsx)(x.Z,{sx:{py:2,px:3},children:(0,a.jsxs)(o.Z,{variant:"body2",fontWeight:700,children:["THỐNG K\xca DỮ LIỆU T\xc0I NGUY\xcaN NƯỚC (",n,")"," "]})})},Z=n(48445),j=n(81782),v=e=>{let{data:t,loading:n}=e,r=t.total,i=t.btnmt,l=t.ubnd,c=[{name:"BTNMT",value:i},{name:"UBND",value:l}],d={labels:null==c?void 0:c.map(e=>e.name),colors:["#0088FE","#FFBB28"],dataLabels:{enabled:!0,style:{fontSize:"15px"},formatter:function(e,t){let n=t.w.globals.labels[t.seriesIndex],a=t.w.globals.seriesTotals[t.seriesIndex];return"".concat(n,": ").concat(a)}},chart:{width:200,type:"pie",events:{dataPointSelection:(e,t,n)=>{console.log(n.w.config.labels[n.dataPointIndex])}}},plotOptions:{pie:{dataLabels:{offset:-20}}},grid:{padding:{top:0,right:0,bottom:0,left:0}},tooltip:{enabled:!0},legend:{show:!1}},u=null==c?void 0:c.map(e=>e.value);return(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(x.Z,{elevation:3,sx:{py:.5,mb:2,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(o.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"giấy ph\xe9p đ\xe3 cấp"})}),n?(0,a.jsx)(Z.Z,{}):(0,a.jsxs)(s.ZP,{container:!0,children:[(0,a.jsxs)(s.ZP,{item:!0,xs:5,md:5,sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",alignItems:"center"},children:[(0,a.jsxs)(s.ZP,{item:!0,xs:12,sx:{textAlign:"center"},children:[(0,a.jsx)(o.Z,{sx:{fontWeight:"bold"},variant:"h6",children:"TỔNG SỐ"}),(0,a.jsx)(o.Z,{sx:{fontWeight:"bold"},variant:"h6",children:r})]}),(0,a.jsxs)(s.ZP,{item:!0,xs:12,px:4,children:[(0,a.jsx)(o.Z,{variant:"subtitle1",children:(0,a.jsxs)(o.Z,{sx:{fontWeight:"bold"},variant:"caption",children:["BTNMT: ",i]})}),(0,a.jsx)(o.Z,{variant:"subtitle1",children:(0,a.jsxs)(o.Z,{sx:{fontWeight:"bold"},variant:"caption",children:["UBND: ",l]})})]})]}),(0,a.jsx)(s.ZP,{item:!0,xs:7,md:7,children:(0,a.jsx)(j.Z,{options:d,series:u,type:"pie",width:200,height:200})})]})]})};function f(e){return e.toLocaleString("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0})}var y=e=>{var t,n;let{data:r,loading:s}=e,i=null==r?void 0:null===(t=r.btnmt)||void 0===t?void 0:t.reduce((e,t)=>e+(t.tongTienCQ||0),0),c=null==r?void 0:null===(n=r.ubnd)||void 0===n?void 0:n.reduce((e,t)=>e+(t.tongTienCQ||0),0);return(0,a.jsxs)(x.Z,{elevation:3,children:[(0,a.jsx)(x.Z,{elevation:3,sx:{py:.5,mb:2,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(o.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"Tiền cấp quyền"})}),s?(0,a.jsx)(Z.Z,{}):(0,a.jsxs)(l.Z,{px:4,pb:4,children:[(0,a.jsxs)(l.Z,{sx:{textAlign:"center"},children:[(0,a.jsx)(o.Z,{sx:{fontWeight:"bold"},children:"TỔNG"}),(0,a.jsxs)(o.Z,{sx:{fontWeight:"bold"},children:[" ",f(i+c)," "]})]}),(0,a.jsxs)(o.Z,{sx:{textAlign:"left"},variant:"subtitle2",children:["BTNMT: ",f(i)," "]}),(0,a.jsxs)(o.Z,{sx:{textAlign:"left"},variant:"subtitle2",children:["UBND: ",f(c)," "]})]})]})},T=n(80539),S=n(51015),w=n(96216),P=n(85871),N=n(5152),C=n.n(N),k=n(95906),D=n(5531),B=n(76213);let R=C()(()=>Promise.all([n.e(4028),n.e(6002),n.e(3701),n.e(9269),n.e(8157),n.e(776),n.e(956),n.e(4424),n.e(6355),n.e(5734),n.e(7316),n.e(9604),n.e(1677)]).then(n.bind(n,89604)),{loadableGenerated:{webpack:()=>[89604]},ssr:!1});var I=()=>{let[e]=(0,r.useState)([15.01,108.79]),[t]=(0,r.useState)(10),[n,s]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!0),{consFilter:d}=(0,k.Z)(),h=(0,D.B)(1).initialItems,[g,b]=(0,r.useState)([]),[p,m]=(0,r.useState)(h),[Z,j]=(0,r.useState)([]),[v,f]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=!0;return s(!0),(0,u.Yu)("cong-trinh/danh-sach",d).then(t=>{e&&b(t)}).catch(console.error).finally(()=>s(!1)),()=>{e=!1}},[]),(0,r.useEffect)(()=>{if(!g.length||!p.length){j([]);return}let e=new Set(p.map(e=>e.toLowerCase()));j(g.filter(t=>{var n,a;let r=(null===(a=t.loaiCT)||void 0===a?void 0:null===(n=a.maLoaiCT)||void 0===n?void 0:n.toString().toLowerCase())||"";return e.has(r)}))},[g,p]),(0,a.jsxs)(x.Z,{elevation:3,sx:{position:"relative",height:"calc(100vh - 170px)"},children:[(0,a.jsx)(x.Z,{elevation:3,sx:{py:.5,textAlign:"center"},children:(0,a.jsx)(o.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"Bản đồ trạng th\xe1i c\xf4ng tr\xecnh"})}),(0,a.jsx)(T.Z,{in:i,children:(0,a.jsx)(l.Z,{className:"map-legend",sx:{background:"white",zIndex:n?-1:999},children:(0,a.jsx)(B.Z,{consType:1,selectedItems:p,onTypeChange:e=>{m(e)},showLabel:v,setShowLabel:f})})}),(0,a.jsx)(S.Z,{className:"toggle-legend",variant:"outlined",onClick:()=>c(e=>!e),children:i?(0,a.jsx)(w.Z,{}):(0,a.jsx)(P.Z,{})}),(0,a.jsx)(R,{center:e,zoom:t,showLabel:v,mapData:Z,loading:n})]})},L=n(59701),W=()=>{let[e,t]=(0,r.useState)({btnmt:[],ubnd:[]}),[n,i]=(0,r.useState)({total:0,btnmt:0,ubnd:0}),[l,o]=(0,r.useState)(!1),c=(0,r.useRef)(!0),{getUserInfo:d}=(0,L.Q)(),x=async()=>{o(!0);try{let e=await (0,u.Yu)("tien-cap-quyen/danh-sach",{startDate:0,endDate:0,coquan_cp:"bo-cap"}),n=await (0,u.Yu)("tien-cap-quyen/danh-sach",{startDate:0,endDate:0,coquan_cp:"tinh-cap"});c.current&&t({btnmt:e,ubnd:n})}catch(e){console.error(e)}finally{o(!1)}},h=async()=>{try{let e=await (0,u.Yu)("giay-phep/dem-theo-co-quan-cp");c.current&&i({total:e.total,btnmt:e.btnmt,ubnd:e.ubndt})}catch(e){console.error(e)}};return(0,r.useEffect)(()=>(c.current=!0,()=>{c.current=!1}),[]),(0,r.useEffect)(()=>{x(),h()},[]),"Construction"==d().role?(0,a.jsx)(I,{}):(0,a.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(s.ZP,{item:!0,xs:12,md:12,children:(0,a.jsx)(m,{})}),(0,a.jsxs)(s.ZP,{item:!0,xs:12,md:4,children:[(0,a.jsx)(s.ZP,{item:!0,xs:12,md:12,children:(0,a.jsx)(p,{})}),(0,a.jsx)(s.ZP,{item:!0,xs:12,md:12,sx:{marginTop:5},children:(0,a.jsx)(v,{data:n,loading:l})}),(0,a.jsx)(s.ZP,{item:!0,xs:12,md:12,sx:{marginTop:5},children:(0,a.jsx)(y,{data:e,loading:l})})]}),(0,a.jsx)(s.ZP,{item:!0,xs:12,md:8,children:(0,a.jsx)(I,{})})]})}}}]);