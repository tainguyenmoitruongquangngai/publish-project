"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6179,1782],{81782:function(e,t,n){var a=n(5152);let s=n.n(a)()(()=>Promise.all([n.e(5279),n.e(7229)]).then(n.bind(n,47229)),{loadableGenerated:{webpack:()=>[47229]},ssr:!1});t.Z=s},46179:function(e,t,n){n.d(t,{Z:function(){return L}});var a=n(85893),s=n(67294),i=n(68573),r=n(77527),l=n(60990),c=n(96788),o=n(14959),d=n(45214),u=n(93454),h=n(23734);let x=(0,r.ZP)(o.Z)(e=>{let{theme:t}=e;return{height:10,borderRadius:5,["&.".concat(d.Z.colorPrimary)]:{backgroundColor:t.palette.grey["light"===t.palette.mode?200:800]},["& .".concat(d.Z.bar)]:{borderRadius:5,backgroundColor:"".concat(t.palette.success.main)}}}),g=(0,r.ZP)(o.Z)(e=>{let{theme:t}=e;return{height:10,borderRadius:5,["&.".concat(d.Z.colorPrimary)]:{backgroundColor:t.palette.grey["light"===t.palette.mode?200:800]},["& .".concat(d.Z.bar)]:{borderRadius:5,backgroundColor:"".concat(t.palette.warning.main)}}}),m=(0,r.ZP)(o.Z)(e=>{let{theme:t}=e;return{height:10,borderRadius:5,["&.".concat(d.Z.colorPrimary)]:{backgroundColor:t.palette.grey["light"===t.palette.mode?200:800]},["& .".concat(d.Z.bar)]:{borderRadius:5,backgroundColor:"".concat(t.palette.error.main)}}});var b=()=>{let[e,t]=(0,s.useState)(0),[n,i]=(0,s.useState)(0),[r,o]=(0,s.useState)(0),[d,b]=(0,s.useState)(0),p=d-15,Z=(0,s.useRef)(!0);return(0,s.useEffect)(()=>(Z.current=!0,()=>{Z.current=!1}),[]),(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,h.getData)("GiamSatSoLieu/danhsach");Z.current&&b(e.length)}catch(e){console.log(e)}finally{}})()},[]),(0,s.useEffect)(()=>{t(15/d*100),i(p/d*100),o(7/d*100)},[7,p,15,d]),(0,a.jsxs)(u.Z,{elevation:3,children:[(0,a.jsx)(u.Z,{elevation:3,sx:{py:.5,mb:2,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(c.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"TRẠNG TH\xc1I C\xd4NG TR\xccNH"})}),(0,a.jsxs)(l.Z,{px:5,pb:5,children:[(0,a.jsxs)(c.Z,{children:["Tổng số: ",d," "]}),(0,a.jsxs)(l.Z,{sx:{paddingTop:3},children:[(0,a.jsxs)(c.Z,{children:["Trạm kết nối b\xecnh thường: ",15," "]}),(0,a.jsx)(x,{variant:"determinate",value:e})]}),(0,a.jsxs)(l.Z,{sx:{paddingTop:3},children:[(0,a.jsxs)(c.Z,{children:["Trạm mất kết nối: ",p," "]}),(0,a.jsx)(g,{variant:"determinate",value:n})]}),(0,a.jsxs)(l.Z,{sx:{paddingTop:3},children:[(0,a.jsxs)(c.Z,{children:["Trạm vận h\xe0nh chưa đ\xfang: ",7," "]}),(0,a.jsx)(m,{variant:"determinate",value:r})]})]})]})},p=()=>{let[e,t]=(0,s.useState)(new Date),[n,i]=(0,s.useState)("");return(0,s.useEffect)(()=>{let n=setInterval(()=>{i(e.toLocaleString()),t(new Date)},1e3);return()=>clearInterval(n)},[e]),(0,a.jsx)(u.Z,{sx:{py:2,px:3},children:(0,a.jsxs)(c.Z,{variant:"body2",fontWeight:700,children:["THỐNG K\xca DỮ LIỆU T\xc0I NGUY\xcaN NƯỚC (",n,")"," "]})})},Z=n(48445),j=n(81782),v=e=>{let{data:t,loading:n}=e,s=t.total,r=t.btnmt,l=t.ubnd,o=[{name:"BTNMT",value:r},{name:"UBND",value:l}],d={labels:null==o?void 0:o.map(e=>e.name),colors:["#0088FE","#FFBB28"],dataLabels:{enabled:!0,style:{fontSize:"15px"},formatter:function(e,t){let n=t.w.globals.labels[t.seriesIndex],a=t.w.globals.seriesTotals[t.seriesIndex];return"".concat(n,": ").concat(a)}},chart:{width:200,type:"pie",events:{dataPointSelection:(e,t,n)=>{console.log(n.w.config.labels[n.dataPointIndex])}}},plotOptions:{pie:{dataLabels:{offset:-20}}},grid:{padding:{top:0,right:0,bottom:0,left:0}},tooltip:{enabled:!0},legend:{show:!1}},h=null==o?void 0:o.map(e=>e.value);return(0,a.jsxs)(u.Z,{children:[(0,a.jsx)(u.Z,{elevation:3,sx:{py:.5,mb:2,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(c.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"giấy ph\xe9p đ\xe3 cấp"})}),n?(0,a.jsx)(Z.Z,{}):(0,a.jsxs)(i.ZP,{container:!0,children:[(0,a.jsxs)(i.ZP,{item:!0,xs:5,md:5,sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",alignItems:"center"},children:[(0,a.jsxs)(i.ZP,{item:!0,xs:12,sx:{textAlign:"center"},children:[(0,a.jsx)(c.Z,{sx:{fontWeight:"bold"},variant:"h6",children:"TỔNG SỐ"}),(0,a.jsx)(c.Z,{sx:{fontWeight:"bold"},variant:"h6",children:s})]}),(0,a.jsxs)(i.ZP,{item:!0,xs:12,px:4,children:[(0,a.jsx)(c.Z,{variant:"subtitle1",children:(0,a.jsxs)(c.Z,{sx:{fontWeight:"bold"},variant:"caption",children:["BTNMT: ",r]})}),(0,a.jsx)(c.Z,{variant:"subtitle1",children:(0,a.jsxs)(c.Z,{sx:{fontWeight:"bold"},variant:"caption",children:["UBND: ",l]})})]})]}),(0,a.jsx)(i.ZP,{item:!0,xs:7,md:7,children:(0,a.jsx)(j.Z,{options:d,series:h,type:"pie",width:200,height:200})})]})]})};function f(e){return e.toLocaleString("vi-VN",{style:"currency",currency:"VND",minimumFractionDigits:0,maximumFractionDigits:0})}var y=e=>{let{data:t,loading:n}=e,s=null==t?void 0:t.btnmt.reduce((e,t)=>e+(t.tongTienCQ||0),0),i=null==t?void 0:t.ubnd.reduce((e,t)=>e+(t.tongTienCQ||0),0);return(0,a.jsxs)(u.Z,{elevation:3,children:[(0,a.jsx)(u.Z,{elevation:3,sx:{py:.5,mb:2,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(c.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"Tiền cấp quyền"})}),n?(0,a.jsx)(Z.Z,{}):(0,a.jsxs)(l.Z,{px:4,pb:4,children:[(0,a.jsxs)(l.Z,{sx:{textAlign:"center"},children:[(0,a.jsx)(c.Z,{sx:{fontWeight:"bold"},children:"TỔNG"}),(0,a.jsxs)(c.Z,{sx:{fontWeight:"bold"},children:[" ",f(s+i)," "]})]}),(0,a.jsxs)(c.Z,{sx:{textAlign:"left"},variant:"subtitle2",children:["BTNMT: ",f(s)," "]}),(0,a.jsxs)(c.Z,{sx:{textAlign:"left"},variant:"subtitle2",children:["UBND: ",f(i)," "]})]})]})},T=n(80539),S=n(56894),w=n(65806),k=n(20607),P=n(51015),C=n(96216),N=n(85871),D=n(5152),_=n.n(D),R=n(76213);let B=_()(()=>Promise.all([n.e(4028),n.e(6002),n.e(3701),n.e(9269),n.e(956),n.e(2110),n.e(6355),n.e(9262),n.e(5734),n.e(7316),n.e(9604),n.e(1677)]).then(n.bind(n,89604)),{loadableGenerated:{webpack:()=>[89604]},ssr:!1});var E=()=>{let[e]=(0,s.useState)([15.01,108.79]),[t]=(0,s.useState)(10),[n,i]=(0,s.useState)(!1),[r,o]=(0,s.useState)(["nuocmat","thuydien","hochua","trambom","tramcapnuoc","cong","nhamaynuoc","nuocduoidat","khaithac","thamdo","congtrinh_nuocduoidatkhac","xathai","khu_cumcn_taptrung","sx_tieuthu_cn","congtrinhkhac_xt"]),[d,x]=(0,s.useState)([]),[g,m]=(0,s.useState)([]),[b,p]=(0,s.useState)(!1),[Z,j]=s.useState(!0),v=(0,s.useRef)(!0),f=async()=>{p(!0),(0,h.getData)("cong-trinh/danh-sach",{tenct:"",loai_ct:0,huyen:0,xa:0,song:0,luuvuc:0,tieu_luuvuc:0,tang_chuanuoc:0,tochuc_canhan:0,nguonnuoc_kt:""}).then(e=>{v.current&&x(e)}).catch(e=>{console.log(e)}).finally(()=>{p(!1)})};return(0,s.useEffect)(()=>(v.current=!0,()=>{v.current=!1}),[]),(0,s.useEffect)(()=>{f()},[]),(0,s.useEffect)(()=>{m(null==d?void 0:d.filter(e=>r.some(t=>{var n,a;return null===(a=e.loaiCT)||void 0===a?void 0:null===(n=a.maLoaiCT)||void 0===n?void 0:n.toString().toLowerCase().includes(t.toLowerCase())})))},[r,d]),(0,a.jsxs)(u.Z,{elevation:3,sx:{position:"relative",height:"calc(100vh - 170px)"},children:[(0,a.jsx)(u.Z,{elevation:3,sx:{py:.5,BorderRadius:0,textAlign:"center"},children:(0,a.jsx)(c.Z,{variant:"overline",sx:{fontWeight:"bold"},children:"Bản đồ trạng th\xe1i c\xf4ng tr\xecnh"})}),(0,a.jsx)(T.Z,{in:Z,children:(0,a.jsxs)(l.Z,{className:"map-legend",sx:{background:"white",zIndex:"".concat(b?-1:999)},children:[(0,a.jsx)(S.Z,{children:(0,a.jsx)(w.Z,{sx:{m:0},control:(0,a.jsx)(k.Z,{onClick:()=>i(!n)}),label:"Hiển thị t\xean c\xf4ng tr\xecnh"})}),(0,a.jsx)(R.Z,{onChange:e=>{o(e)}})]})}),(0,a.jsx)(P.Z,{className:"toggle-legend",variant:"outlined",onClick:()=>{j(!Z)},children:Z?(0,a.jsx)(C.Z,{}):(0,a.jsx)(N.Z,{})}),(0,a.jsx)(B,{center:e,zoom:t,showLabel:n,mapData:g,loading:b})]})},W=n(59701),I=n(96245),L=()=>{let[e,t]=(0,s.useState)({btnmt:[],ubnd:[]}),[n,r]=(0,s.useState)({total:0,btnmt:0,ubnd:0}),[l,c]=(0,s.useState)(!1),o=(0,s.useRef)(!0),{getAuthToken:d}=(0,W.Q)(),u=d(),[x,g]=(0,s.useState)(null);(0,s.useEffect)(()=>{u&&g((0,I.Z)(u)["http://schemas.microsoft.com/ws/2008/06/identity/claims/role"])},[u]);let m=async()=>{c(!0);try{let e=await (0,h.getData)("tien-cap-quyen/danh-sach",{startDate:0,endDate:0,coquan_cp:"bo-cap"}),n=await (0,h.getData)("tien-cap-quyen/danh-sach",{startDate:0,endDate:0,coquan_cp:"tinh-cap"});o.current&&t({btnmt:e,ubnd:n})}catch(e){console.error(e)}finally{c(!1)}},Z=async()=>{try{let e=await (0,h.getData)("giay-phep/dem-theo-co-quan-cp");o.current&&r({total:e.total,btnmt:e.btnmt,ubnd:e.ubndt})}catch(e){console.error(e)}};return(0,s.useEffect)(()=>(o.current=!0,()=>{o.current=!1}),[]),(0,s.useEffect)(()=>{m(),Z()},[]),"Construction"==x?(0,a.jsx)(E,{}):(0,a.jsxs)(i.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,md:12,children:(0,a.jsx)(p,{})}),(0,a.jsxs)(i.ZP,{item:!0,xs:12,md:4,children:[(0,a.jsx)(i.ZP,{item:!0,xs:12,md:12,children:(0,a.jsx)(b,{})}),(0,a.jsx)(i.ZP,{item:!0,xs:12,md:12,sx:{marginTop:5},children:(0,a.jsx)(v,{data:n,loading:l})}),(0,a.jsx)(i.ZP,{item:!0,xs:12,md:12,sx:{marginTop:5},children:(0,a.jsx)(y,{data:e,loading:l})})]}),(0,a.jsx)(i.ZP,{item:!0,xs:12,md:8,children:(0,a.jsx)(E,{})})]})}}}]);